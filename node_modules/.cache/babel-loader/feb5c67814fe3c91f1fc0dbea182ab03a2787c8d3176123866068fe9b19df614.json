{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport { ref, watchEffect } from 'vue';\nimport { useRoute } from 'vue-router';\nimport { useStore } from '@/stores/store';\nimport ModalComponent from '@/components/ModalComponent.vue';\nexport default {\n  __name: 'HouseDetailsView',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const route = useRoute();\n    const store = useStore();\n    const houseDetails = ref(null);\n    const isLoading = ref(true);\n    const showModal = ref(route.query.delete === \"true\");\n    const recommendations = ref([]);\n    const fetchData = async () => {\n      if (route.name === 'HouseDetailsView') {\n        await store.getHouses();\n        console.log(\"Fetched houses:\", store.houses);\n        // determine the current house:\n        const house = store.houses.find(house => house.id === parseInt(route.params.id));\n        console.log(\"Found house:\", house);\n        if (house) {\n          houseDetails.value = house;\n          console.log(\"houseDetails.value.image: \", houseDetails.value.image);\n          console.log('House details updated:', houseDetails.value);\n          // for all houses except of the current house:\n          const restHouses = store.houses.filter(house => house.id !== parseInt(route.params.id));\n          console.log(\"Rest houses:\", restHouses);\n          // sort recommended houses by the closest prices:\n          recommendations.value = restHouses.map(item => {\n            // add .module and get module of the prices difference:\n            item.module = Math.abs(houseDetails.value.price - item.price);\n            return item;\n          })\n          // sort houses by modules and get 3 with the smallest modules:\n          .sort((a, b) => a.module - b.module).slice(0, 3);\n          console.log('Recommendations:', recommendations.value);\n        } else {\n          console.error(`House with ID ${route.params.id} not found.`);\n        }\n      }\n    };\n    watchEffect(async () => {\n      const idParam = route.params.id;\n      if (!idParam) return;\n      isLoading.value = true;\n      try {\n        const id = Number(idParam);\n        houseDetails.value = await store.getHouseById(id);\n        fetchData();\n      } catch (err) {\n        console.error('Error while fetching house:', err);\n        houseDetails.value = null;\n      } finally {\n        isLoading.value = false;\n      }\n    });\n    const __returned__ = {\n      route,\n      store,\n      houseDetails,\n      isLoading,\n      showModal,\n      recommendations,\n      fetchData,\n      ref,\n      watchEffect,\n      get useRoute() {\n        return useRoute;\n      },\n      get useStore() {\n        return useStore;\n      },\n      ModalComponent\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","watchEffect","useRoute","useStore","ModalComponent","route","store","houseDetails","isLoading","showModal","query","delete","recommendations","fetchData","name","getHouses","console","log","houses","house","find","id","parseInt","params","value","image","restHouses","filter","map","item","module","Math","abs","price","sort","a","b","slice","error","idParam","Number","getHouseById","err"],"sources":["/home/kisa/dtt assessment/house-listings/src/views/HouseDetailsView.vue"],"sourcesContent":["<template>\n\n    <div class=\"house-details main\">\n    <!-- Loader -->\n    <div v-if=\"isLoading\" class=\"main-house-card --loading\">\n      Loading house...\n    </div>\n\n    <!-- Error / not found -->\n    <div v-else-if=\"!houseDetails\" class=\"main-house-card --loading\">\n      House not found\n    </div>\n\n    <!-- Only render when data exists -->\n    <article v-else class=\"main-house-card\">\n\n    <router-link to=\"/\" class=\"btn btn-back\">\n      <picture>\n          <!-- Small devices -->\n          <source srcset=\"../assets/ic_back_white@3x.png\" media=\"(max-width: 768px)\">\n          <!-- Large devices -->\n          <source srcset=\"../assets/ic_back_grey@3x.png\">\n          <img class=\"btn-back-icon\" src=\"../assets/ic_back_grey@3x.png\" alt=\"Back\">\n      </picture> \n      <span class=\"btn-back-label\">Back to overview</span>\n    </router-link>\n\n    <!-- Small devices -->\n    <div class=\"house-actions-sm\" v-if=\"houseDetails?.madeByMe\">\n      <router-link\n        :to=\"{ name: 'HouseEditView', params: { id: $route.params.id }}\"\n        class=\"btn btn-edit\">\n          <img class=\"btn-edit-icon\" src=\"../assets/ic_edit_white@3x.png\" alt=\"Edit\" />\n      </router-link>\n\n      <button class=\"btn btn-delete\" @click=\"showModal = true\">\n          <img class=\"btn-delete-icon\" src=\"../assets/ic_delete_white@3x.png\" alt=\"Delete\" />\n      </button>\n    </div>\n\n      <img\n        class=\"main-house-card-image\"\n        :src=\"houseDetails?.image\"\n        alt=\"House\"\n      />\n\n      <div class=\"main-house-card-info\">\n        <div class=\"main-house-card-header\">\n          <h3 class=\"main-house-card-title\">\n            {{ houseDetails?.location?.street }} {{ houseDetails?.location?.houseNumber }}\n          </h3>\n\n          <!-- Large devices -->\n          <div class=\"house-actions\" v-if=\"houseDetails?.madeByMe\">\n            <router-link\n              :to=\"{ name: 'HouseEditView', params: { id: $route.params.id }}\"\n              class=\"btn btn-edit\">\n                <img class=\"btn-edit-icon\" src=\"../assets/ic_edit@3x.png\" alt=\"Edit\" />\n            </router-link>\n\n            <button class=\"btn btn-delete\" @click=\"showModal = true\">\n                <img class=\"btn-delete-icon\" src=\"../assets/ic_delete@3x.png\" alt=\"Delete\" />\n            </button>\n          </div>\n      </div>\n\n        <p class=\"main-house-card-meta\">\n          <span class=\"meta-item\">\n            <img src=\"../assets/ic_location@3x.png\" alt=\"Location\" />\n            {{ houseDetails?.location?.zip }} {{ houseDetails?.location?.city }}\n          </span>\n        </p>\n\n        <p class=\"main-house-card-meta\">\n          <span class=\"meta-item\">\n            <img src=\"../assets/ic_price@3x.png\" alt=\"Price\" />\n            {{ houseDetails?.price }}\n          </span>\n\n          <span class=\"meta-item\">\n            <img src=\"../assets/ic_size@3x.png\" alt=\"Size\" />\n            {{ houseDetails?.size }} m2\n          </span>\n\n          <span class=\"meta-item\">\n            <img src=\"../assets/ic_construction_date@3x.png\" alt=\"Construction Year\" />\n            Built in {{ houseDetails?.constructionYear }}\n          </span>\n        </p>\n\n        <p class=\"main-house-card-meta\">\n          <span class=\"meta-item\">\n            <img src=\"../assets/ic_bed@3x.png\" alt=\"Bed\" />\n            {{ houseDetails?.rooms?.bedrooms }}\n          </span>\n\n          <span class=\"meta-item\">\n            <img src=\"../assets/ic_bath@3x.png\" alt=\"Bath\" />\n            {{ houseDetails?.rooms?.bathrooms }}\n          </span>\n\n          <span class=\"meta-item\">\n            <img src=\"../assets/ic_garage@3x.png\" alt=\"Garage\" />\n            {{ houseDetails?.hasGarage ? 'Yes' : 'No' }}\n          </span>\n        </p>\n        \n        <p class=\"main-house-card-description\">\n          {{ houseDetails?.description }}\n        </p>\n\n      </div>\n    </article>\n\n    <div class=\"recommended-houses\">\n      <h2>Recommended for you</h2>\n      <div v-for=\"recommendedHouse in recommendations\" :key=\"recommendedHouse.id\" class=\"recommended-house\">\n          <div class=\"recommended-card-info\" @click=\"navigateToHouseDetails(recommendedHouse.id)\">\n              <img :src=\"recommendedHouse.image\" class=\"recommended-card-info-img\" alt=\"House Image\" />\n              <div class=\"recommended-card-text\">\n                  <h3>{{ recommendedHouse.location.street }} {{ recommendedHouse.location.houseNumber }}</h3>\n                  <p>â‚¬ {{ recommendedHouse.price }} </p>\n                  <p>{{ recommendedHouse.location.zip }} {{ recommendedHouse.location.city }}</p>\n                  <p><img src=\"../assets/ic_bed@3x.png\" alt=\"Bed\" /> {{ recommendedHouse.rooms.bedrooms }} <img src=\"../assets/ic_bath@3x.png\" alt=\"Bath\" /> {{ recommendedHouse.rooms.bathrooms }} <img src=\"../assets/ic_size@3x.png\" alt=\"Size\" /> {{ recommendedHouse.size }} m2</p>\n              </div>\n          </div>\n      </div>\n    </div>\n    <ModalComponent v-if=\"showModal\" :house=\"houseDetails\" @close=\"showModal = false\"/>\n  </div>\n</template>\n\n<script setup>\nimport { ref, watchEffect } from 'vue'\nimport { useRoute } from 'vue-router'\nimport { useStore } from '@/stores/store'\nimport ModalComponent from '@/components/ModalComponent.vue'\n\nconst route = useRoute()\nconst store = useStore()\n\nconst houseDetails = ref(null)\nconst isLoading = ref(true)\nconst showModal = ref(route.query.delete === \"true\");\nconst recommendations = ref([]);\n\n\nconst fetchData = async () => {\n  if (route.name === 'HouseDetailsView') {\n      await store.getHouses();\n      console.log(\"Fetched houses:\", store.houses);\n      // determine the current house:\n      const house = store.houses.find((house) => house.id === parseInt(route.params.id));\n      console.log(\"Found house:\", house);\n      if (house) {\n          houseDetails.value = house;\n          console.log(\"houseDetails.value.image: \", houseDetails.value.image)\n          console.log('House details updated:', houseDetails.value);\n          // for all houses except of the current house:\n          const restHouses = store.houses.filter(house => house.id !== parseInt(route.params.id));\n          console.log(\"Rest houses:\", restHouses);\n          // sort recommended houses by the closest prices:\n          recommendations.value = restHouses\n              .map(item => {\n                  // add .module and get module of the prices difference:\n                  item.module = Math.abs(houseDetails.value.price - item.price);\n                  return item;\n              })\n              // sort houses by modules and get 3 with the smallest modules:\n              .sort((a, b) => a.module - b.module)\n              .slice(0, 3);\n          console.log('Recommendations:', recommendations.value);\n      } else {\n          console.error(`House with ID ${route.params.id} not found.`);\n      }\n  }\n};\n\nwatchEffect(async () => {\n  const idParam = route.params.id\n  if (!idParam) return\n\n  isLoading.value = true\n  try {\n    const id = Number(idParam)\n    houseDetails.value = await store.getHouseById(id)\n    fetchData();\n  } catch (err) {\n    console.error('Error while fetching house:', err)\n    houseDetails.value = null\n  } finally {\n    isLoading.value = false\n  }\n})\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}