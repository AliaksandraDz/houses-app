{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport { defineStore } from 'pinia';\nimport { baseUrl } from '../shared/baseUrl';\nimport { apiKey } from '../shared/apiKey';\nexport const useStore = defineStore('store', {\n  state: () => ({\n    houses: [],\n    isActive: 'price',\n    searchInput: ''\n  }),\n  actions: {\n    async getHouses() {\n      const res = await fetch(`${baseUrl}`, {\n        method: \"GET\",\n        headers: {\n          \"X-Api-Key\": apiKey\n        }\n      });\n      if (!res.ok) {\n        console.error('Failed to fetch houses', res.status);\n        return;\n      }\n      this.houses = await res.json();\n    },\n    async getHouseById(id) {\n      const res = await fetch(`${baseUrl}/${id}`, {\n        method: \"GET\",\n        headers: {\n          \"X-Api-Key\": apiKey\n        }\n      });\n      if (!res.ok) {\n        throw new Error(`Failed to fetch house ${id}`);\n      }\n      const data = await res.json();\n      return data[0]; // always return a single object\n    },\n    async deleteHouse(id) {\n      const res = await fetch(`${baseUrl}/${id}`, {\n        method: \"DELETE\",\n        headers: {\n          \"X-Api-Key\": apiKey\n        }\n      });\n      if (!res.ok) {\n        throw new Error(`Failed to delete house ${id}`);\n      }\n    },\n    toggleActive(buttonType) {\n      this.isActive = buttonType;\n    },\n    async addHouse(houseFormData, imageFormData) {\n      const res = await fetch(baseUrl, {\n        method: 'POST',\n        headers: {\n          'X-Api-Key': apiKey\n        },\n        body: houseFormData\n      });\n      if (!res.ok) {\n        throw new Error('Failed to create house');\n      }\n      const createdHouse = await res.json();\n      const imageRes = await fetch(`${baseUrl}/${createdHouse.id}/upload`, {\n        method: 'POST',\n        headers: {\n          'X-Api-Key': apiKey\n        },\n        body: imageFormData\n      });\n      if (!imageRes.ok) {\n        throw new Error('Failed to upload image');\n      }\n      const houseWithOwnership = {\n        ...createdHouse,\n        madeByMe: true\n      };\n      this.houses.push(houseWithOwnership);\n      return houseWithOwnership;\n    },\n    async editHouse(houseFormData, imageFormData, id) {\n      const res = await fetch(`${baseUrl}/${id}`, {\n        method: 'POST',\n        headers: {\n          'X-Api-Key': apiKey\n        },\n        body: houseFormData\n      });\n      if (!res.ok) {\n        throw new Error(`Failed to update house ${id}`);\n      }\n      if (imageFormData) {\n        const imageRes = await fetch(`${baseUrl}/${id}/upload`, {\n          method: 'POST',\n          headers: {\n            'X-Api-Key': apiKey\n          },\n          body: imageFormData\n        });\n        if (!imageRes.ok) {\n          throw new Error('Failed to upload image');\n        }\n      }\n      const index = this.houses.findIndex(h => h.id === id);\n      if (index !== -1) {\n        this.houses[index] = {\n          ...this.houses[index],\n          ...Object.fromEntries(houseFormData)\n        };\n      }\n    },\n    clearSearch() {\n      this.searchInput = '';\n    }\n  },\n  getters: {\n    filteredHouses(state) {\n      const query = state.searchInput.toLowerCase().trim();\n      const sorted = [...state.houses].sort((a, b) => {\n        if (state.isActive === 'price') return a.price - b.price;\n        if (state.isActive === 'size') return a.size - b.size;\n        return 0;\n      });\n      if (!query) return sorted;\n      return sorted.filter(house => {\n        if (!house.location) return false;\n        const street = house.location.street?.toLowerCase() || '';\n        const city = house.location.city?.toLowerCase() || '';\n        return street.includes(query) || city.includes(query);\n      });\n    }\n  }\n});","map":{"version":3,"names":["defineStore","baseUrl","apiKey","useStore","state","houses","isActive","searchInput","actions","getHouses","res","fetch","method","headers","ok","console","error","status","json","getHouseById","id","Error","data","deleteHouse","toggleActive","buttonType","addHouse","houseFormData","imageFormData","body","createdHouse","imageRes","houseWithOwnership","madeByMe","push","editHouse","index","findIndex","h","Object","fromEntries","clearSearch","getters","filteredHouses","query","toLowerCase","trim","sorted","sort","a","b","price","size","filter","house","location","street","city","includes"],"sources":["/home/kisa/dtt assessment/house-listings/src/stores/store.js"],"sourcesContent":["import { defineStore } from 'pinia';\nimport { baseUrl } from '../shared/baseUrl';\nimport { apiKey } from '../shared/apiKey';\n\nexport const useStore = defineStore('store', {\n  state: () => ({\n    houses: [],\n    isActive: 'price',\n    searchInput: '',\n  }),\n\n  actions: {\n    async getHouses() {\n      const res = await fetch(`${baseUrl}`, {\n        method: \"GET\",\n        headers: { \"X-Api-Key\": apiKey },\n      });\n\n      if (!res.ok) {\n        console.error('Failed to fetch houses', res.status);\n        return;\n      }\n\n      this.houses = await res.json();\n\n    },\n\n    async getHouseById(id) {\n      const res = await fetch(`${baseUrl}/${id}`, {\n        method: \"GET\",\n        headers: { \"X-Api-Key\": apiKey },\n      });\n    \n      if (!res.ok) {\n        throw new Error(`Failed to fetch house ${id}`);\n      }\n    \n      const data = await res.json()\n      return data[0]  // always return a single object\n    },\n\n    async deleteHouse(id) {\n      const res = await fetch(`${baseUrl}/${id}`, {\n        method: \"DELETE\",\n        headers: {\n          \"X-Api-Key\": apiKey\n        },\n      });\n          \n      if (!res.ok) {\n        throw new Error(`Failed to delete house ${id}`);\n      }\n    },\n\n    toggleActive(buttonType) {\n      this.isActive = buttonType;\n    },\n\n    async addHouse(houseFormData, imageFormData) {\n\n      const res = await fetch(baseUrl, {\n        method: 'POST',\n        headers: {\n          'X-Api-Key': apiKey,\n        },\n        body: houseFormData,\n      })\n    \n      if (!res.ok) {\n        throw new Error('Failed to create house')\n      }\n    \n      const createdHouse = await res.json()\n    \n      const imageRes = await fetch(\n        `${baseUrl}/${createdHouse.id}/upload`,\n        {\n          method: 'POST',\n          headers: {\n            'X-Api-Key': apiKey,\n          },\n          body: imageFormData,\n        }\n      )\n    \n      if (!imageRes.ok) {\n        throw new Error('Failed to upload image')\n      }\n\n      const houseWithOwnership = {\n        ...createdHouse,\n        madeByMe: true,\n      }\n    \n      this.houses.push(houseWithOwnership)\n    \n      return houseWithOwnership\n    },\n\n    async editHouse(houseFormData, imageFormData, id) {\n      const res = await fetch(`${baseUrl}/${id}`, {\n        method: 'POST',\n        headers: {\n          'X-Api-Key': apiKey,\n        },\n        body: houseFormData,\n      })\n    \n      if (!res.ok) {\n        throw new Error(`Failed to update house ${id}`)\n      }\n    \n      if (imageFormData) {\n        const imageRes = await fetch(`${baseUrl}/${id}/upload`, {\n          method: 'POST',\n          headers: {\n            'X-Api-Key': apiKey,\n          },\n          body: imageFormData,\n        })\n    \n        if (!imageRes.ok) {\n          throw new Error('Failed to upload image')\n        }\n      }\n\n      const index = this.houses.findIndex(h => h.id === id)\n      if (index !== -1) {\n        this.houses[index] = {\n          ...this.houses[index],\n          ...Object.fromEntries(houseFormData),\n        }\n      }\n    },\n    \n\n    clearSearch() {\n      this.searchInput = '';\n    },\n  },\n\n  getters: {\n    filteredHouses(state) {\n      const query = state.searchInput.toLowerCase().trim();\n\n      const sorted = [...state.houses].sort((a, b) => {\n        if (state.isActive === 'price') return a.price - b.price;\n        if (state.isActive === 'size') return a.size - b.size;\n        return 0;\n      });\n\n      if (!query) return sorted;\n\n      return sorted.filter((house) => {\n        if (!house.location) return false;\n        const street = house.location.street?.toLowerCase() || '';\n        const city = house.location.city?.toLowerCase() || '';\n        return street.includes(query) || city.includes(query);\n      });\n    },\n  },\n});\n"],"mappings":";;;AAAA,SAASA,WAAW,QAAQ,OAAO;AACnC,SAASC,OAAO,QAAQ,mBAAmB;AAC3C,SAASC,MAAM,QAAQ,kBAAkB;AAEzC,OAAO,MAAMC,QAAQ,GAAGH,WAAW,CAAC,OAAO,EAAE;EAC3CI,KAAK,EAAEA,CAAA,MAAO;IACZC,MAAM,EAAE,EAAE;IACVC,QAAQ,EAAE,OAAO;IACjBC,WAAW,EAAE;EACf,CAAC,CAAC;EAEFC,OAAO,EAAE;IACP,MAAMC,SAASA,CAAA,EAAG;MAChB,MAAMC,GAAG,GAAG,MAAMC,KAAK,CAAC,GAAGV,OAAO,EAAE,EAAE;QACpCW,MAAM,EAAE,KAAK;QACbC,OAAO,EAAE;UAAE,WAAW,EAAEX;QAAO;MACjC,CAAC,CAAC;MAEF,IAAI,CAACQ,GAAG,CAACI,EAAE,EAAE;QACXC,OAAO,CAACC,KAAK,CAAC,wBAAwB,EAAEN,GAAG,CAACO,MAAM,CAAC;QACnD;MACF;MAEA,IAAI,CAACZ,MAAM,GAAG,MAAMK,GAAG,CAACQ,IAAI,CAAC,CAAC;IAEhC,CAAC;IAED,MAAMC,YAAYA,CAACC,EAAE,EAAE;MACrB,MAAMV,GAAG,GAAG,MAAMC,KAAK,CAAC,GAAGV,OAAO,IAAImB,EAAE,EAAE,EAAE;QAC1CR,MAAM,EAAE,KAAK;QACbC,OAAO,EAAE;UAAE,WAAW,EAAEX;QAAO;MACjC,CAAC,CAAC;MAEF,IAAI,CAACQ,GAAG,CAACI,EAAE,EAAE;QACX,MAAM,IAAIO,KAAK,CAAC,yBAAyBD,EAAE,EAAE,CAAC;MAChD;MAEA,MAAME,IAAI,GAAG,MAAMZ,GAAG,CAACQ,IAAI,CAAC,CAAC;MAC7B,OAAOI,IAAI,CAAC,CAAC,CAAC,EAAE;IAClB,CAAC;IAED,MAAMC,WAAWA,CAACH,EAAE,EAAE;MACpB,MAAMV,GAAG,GAAG,MAAMC,KAAK,CAAC,GAAGV,OAAO,IAAImB,EAAE,EAAE,EAAE;QAC1CR,MAAM,EAAE,QAAQ;QAChBC,OAAO,EAAE;UACP,WAAW,EAAEX;QACf;MACF,CAAC,CAAC;MAEF,IAAI,CAACQ,GAAG,CAACI,EAAE,EAAE;QACX,MAAM,IAAIO,KAAK,CAAC,0BAA0BD,EAAE,EAAE,CAAC;MACjD;IACF,CAAC;IAEDI,YAAYA,CAACC,UAAU,EAAE;MACvB,IAAI,CAACnB,QAAQ,GAAGmB,UAAU;IAC5B,CAAC;IAED,MAAMC,QAAQA,CAACC,aAAa,EAAEC,aAAa,EAAE;MAE3C,MAAMlB,GAAG,GAAG,MAAMC,KAAK,CAACV,OAAO,EAAE;QAC/BW,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UACP,WAAW,EAAEX;QACf,CAAC;QACD2B,IAAI,EAAEF;MACR,CAAC,CAAC;MAEF,IAAI,CAACjB,GAAG,CAACI,EAAE,EAAE;QACX,MAAM,IAAIO,KAAK,CAAC,wBAAwB,CAAC;MAC3C;MAEA,MAAMS,YAAY,GAAG,MAAMpB,GAAG,CAACQ,IAAI,CAAC,CAAC;MAErC,MAAMa,QAAQ,GAAG,MAAMpB,KAAK,CAC1B,GAAGV,OAAO,IAAI6B,YAAY,CAACV,EAAE,SAAS,EACtC;QACER,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UACP,WAAW,EAAEX;QACf,CAAC;QACD2B,IAAI,EAAED;MACR,CACF,CAAC;MAED,IAAI,CAACG,QAAQ,CAACjB,EAAE,EAAE;QAChB,MAAM,IAAIO,KAAK,CAAC,wBAAwB,CAAC;MAC3C;MAEA,MAAMW,kBAAkB,GAAG;QACzB,GAAGF,YAAY;QACfG,QAAQ,EAAE;MACZ,CAAC;MAED,IAAI,CAAC5B,MAAM,CAAC6B,IAAI,CAACF,kBAAkB,CAAC;MAEpC,OAAOA,kBAAkB;IAC3B,CAAC;IAED,MAAMG,SAASA,CAACR,aAAa,EAAEC,aAAa,EAAER,EAAE,EAAE;MAChD,MAAMV,GAAG,GAAG,MAAMC,KAAK,CAAC,GAAGV,OAAO,IAAImB,EAAE,EAAE,EAAE;QAC1CR,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UACP,WAAW,EAAEX;QACf,CAAC;QACD2B,IAAI,EAAEF;MACR,CAAC,CAAC;MAEF,IAAI,CAACjB,GAAG,CAACI,EAAE,EAAE;QACX,MAAM,IAAIO,KAAK,CAAC,0BAA0BD,EAAE,EAAE,CAAC;MACjD;MAEA,IAAIQ,aAAa,EAAE;QACjB,MAAMG,QAAQ,GAAG,MAAMpB,KAAK,CAAC,GAAGV,OAAO,IAAImB,EAAE,SAAS,EAAE;UACtDR,MAAM,EAAE,MAAM;UACdC,OAAO,EAAE;YACP,WAAW,EAAEX;UACf,CAAC;UACD2B,IAAI,EAAED;QACR,CAAC,CAAC;QAEF,IAAI,CAACG,QAAQ,CAACjB,EAAE,EAAE;UAChB,MAAM,IAAIO,KAAK,CAAC,wBAAwB,CAAC;QAC3C;MACF;MAEA,MAAMe,KAAK,GAAG,IAAI,CAAC/B,MAAM,CAACgC,SAAS,CAACC,CAAC,IAAIA,CAAC,CAAClB,EAAE,KAAKA,EAAE,CAAC;MACrD,IAAIgB,KAAK,KAAK,CAAC,CAAC,EAAE;QAChB,IAAI,CAAC/B,MAAM,CAAC+B,KAAK,CAAC,GAAG;UACnB,GAAG,IAAI,CAAC/B,MAAM,CAAC+B,KAAK,CAAC;UACrB,GAAGG,MAAM,CAACC,WAAW,CAACb,aAAa;QACrC,CAAC;MACH;IACF,CAAC;IAGDc,WAAWA,CAAA,EAAG;MACZ,IAAI,CAAClC,WAAW,GAAG,EAAE;IACvB;EACF,CAAC;EAEDmC,OAAO,EAAE;IACPC,cAAcA,CAACvC,KAAK,EAAE;MACpB,MAAMwC,KAAK,GAAGxC,KAAK,CAACG,WAAW,CAACsC,WAAW,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC;MAEpD,MAAMC,MAAM,GAAG,CAAC,GAAG3C,KAAK,CAACC,MAAM,CAAC,CAAC2C,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAK;QAC9C,IAAI9C,KAAK,CAACE,QAAQ,KAAK,OAAO,EAAE,OAAO2C,CAAC,CAACE,KAAK,GAAGD,CAAC,CAACC,KAAK;QACxD,IAAI/C,KAAK,CAACE,QAAQ,KAAK,MAAM,EAAE,OAAO2C,CAAC,CAACG,IAAI,GAAGF,CAAC,CAACE,IAAI;QACrD,OAAO,CAAC;MACV,CAAC,CAAC;MAEF,IAAI,CAACR,KAAK,EAAE,OAAOG,MAAM;MAEzB,OAAOA,MAAM,CAACM,MAAM,CAAEC,KAAK,IAAK;QAC9B,IAAI,CAACA,KAAK,CAACC,QAAQ,EAAE,OAAO,KAAK;QACjC,MAAMC,MAAM,GAAGF,KAAK,CAACC,QAAQ,CAACC,MAAM,EAAEX,WAAW,CAAC,CAAC,IAAI,EAAE;QACzD,MAAMY,IAAI,GAAGH,KAAK,CAACC,QAAQ,CAACE,IAAI,EAAEZ,WAAW,CAAC,CAAC,IAAI,EAAE;QACrD,OAAOW,MAAM,CAACE,QAAQ,CAACd,KAAK,CAAC,IAAIa,IAAI,CAACC,QAAQ,CAACd,KAAK,CAAC;MACvD,CAAC,CAAC;IACJ;EACF;AACF,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}